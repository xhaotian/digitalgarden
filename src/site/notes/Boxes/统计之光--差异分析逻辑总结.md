---
{"dg-publish":true,"permalink":"/Boxes/统计之光--差异分析逻辑总结/","tags":["input","fleeting"]}
---

需先明确数据分类

##### 数据分类
方式：生成类型列，布尔运算，索引，合并
最终生成（表达+表型）x（训练+验证） 
##### 差异分析★★★★
###### 生成design数据集
```R
dds <-DESeqDataSetFromMatrix(countData=counts_training,  #此处函数要求counts数据必须为整数 
                              colData=diff_group,  #样本信息（包含分组列，type/性别/分组/批次等）
                              design= ~type)              #实验设计：按type分组进行差异分析
# # 返回的是一个包含实验设计等信息的数据集
```
###### 差异分析计算
 ```R
dds <- DESeq(dds)
# 耗时
 ```
###### 获取差异分析结果
```R
res <- results(dds,alpha=0.05)   # α要求应与后面padj保持相同
resSig <- subset(res,(abs(log2FoldChange)>0.58) & padj <0.05)  # 可以认为表达量相差1.5倍为显著
resSig <- as.data.frame(resSig)
diff_gene <- rownames(resSig) #提取列名，此为所求结果
save(diff_gene,file = "diff_gene.rda") 
```
##### 与ADME基因取交集
 







---
 <html lang="zh-CN"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>数据分类关系表</title> <style> body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background-color: #f8f9fa; color: #333; } .container { max-width: 1000px; margin: 0 auto; background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); } h1 { text-align: center; color: #2c3e50; margin-bottom: 30px; padding-bottom: 15px; border-bottom: 2px solid #eee; } .data-table { width: 100%; border-collapse: collapse; margin: 20px 0; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05); } .data-table th, .data-table td { border: 1px solid #ddd; padding: 12px 15px; text-align: center; } .data-table th { background-color: #2c3e50; color: white; font-weight: 600; } .data-table tr:nth-child(even) { background-color: #f9f9f9; } .group-header { background-color: #34495e !important; color: white; } .training-data { background-color: #d4edda; } .validation-data { background-color: #cce5ff; } .normal-data { background-color: #f8d7da; } .legend { display: flex; justify-content: center; margin-top: 30px; flex-wrap: wrap; } .legend-item { display: flex; align-items: center; margin: 0 15px; } .color-box { width: 20px; height: 20px; margin-right: 8px; border: 1px solid #ddd; } .section { margin: 30px 0; } .section-title { font-size: 1.2em; font-weight: 600; color: #2c3e50; margin-bottom: 15px; padding-bottom: 8px; border-bottom: 1px solid #eee; } .note { background-color: #fff3cd; padding: 15px; border-left: 4px solid #ffc107; margin-top: 20px; border-radius: 4px; } </style> </head> <body> <div class="container"> <h1>数据分类关系表</h1> <div class="section"> <div class="section-title">数据组成结构</div> <table class="data-table"> <tr> <th>数据类型</th> <th colspan="2">基因表达数据</th> <th colspan="2">样本表型数据</th> </tr> <tr> <th>数据分组</th> <th>训练集</th> <th>验证集</th> <th>训练集</th> <th>验证集</th> </tr> <tr> <td class="group-header">肿瘤组</td> <td class="training-data">50%</td> <td class="validation-data">50%</td> <td class="training-data">50%</td> <td class="validation-data">50%</td> </tr> <tr> <td class="group-header">正常组</td> <td class="training-data" colspan="2">100%</td> <td class="training-data" colspan="2">100%</td> </tr> </table> </div> <div class="section"> <div class="section-title">训练数据与验证数据组成</div> <table class="data-table"> <tr> <th>数据类别</th> <th>基因表达数据</th> <th>样本表型数据</th> </tr> <tr> <td class="group-header">训练数据</td> <td class="training-data">肿瘤组训练集(50%) + 正常组(100%)</td> <td class="training-data">肿瘤组训练集(50%) + 正常组(100%)</td> </tr> <tr> <td class="group-header">验证数据</td> <td class="validation-data">肿瘤组验证集(50%)</td> <td class="validation-data">肿瘤组验证集(50%)</td> </tr> </table> </div> <div class="legend"> <div class="legend-item"> <div class="color-box" style="background-color: #d4edda;"></div> <span>训练数据</span> </div> <div class="legend-item"> <div class="color-box" style="background-color: #cce5ff;"></div> <span>验证数据</span> </div> <div class="legend-item"> <div class="color-box" style="background-color: #f8d7da;"></div> <span>正常组数据</span> </div> </div> <div class="note"> <strong>说明：</strong> 肿瘤组数据被平均分为训练集和验证集（各50%），正常组数据全部用于训练。训练数据包括基因表达数据和样本表型数据的肿瘤组训练集和正常组全部数据；验证数据包括基因表达数据和样本表型数据的肿瘤组验证集。 </div> </div> </body> </html>


